# 2D飞机射击游戏 - 项目规划

## 1. 技术栈选择 ✅

### 已确定：
- [x] **Vue 3** - 主框架（UI、路由、状态管理）
- [x] **Phaser 3** - 游戏引擎（游戏逻辑和渲染）
- [x] **TypeScript** - 开发语言
- [x] **Vite** - 构建工具

### 架构设计：
```
Vue 3 (外层)
├── 主菜单页面
├── 游戏页面 (包含Phaser游戏实例)
├── 设置页面
└── 排行榜页面

Phaser 3 (游戏内)
├── 游戏场景
├── 玩家系统
├── 敌人系统
└── 碰撞检测
```

## 2. 游戏玩法设计 ✅

### 核心玩法：
- **游戏类型**：纵向卷轴射击游戏（从底部往上打）
- **关卡结构**：每关从起点打到Boss
- **胜利条件**：击败Boss通关

### 玩家飞机系统 ✅
```typescript
interface Player {
  hp: number;              // 血条（生命值）
  maxHp: number;           // 最大生命值
  attack: number;          // 攻击力（影响子弹伤害）
  defense: number;         // 防御力（护盾值，减少固定伤害）
  ultimate: {
    count: number;         // 大招剩余次数（每关固定次数）
    effect: 'clearScreen'  // 全屏清屏效果
  }
  position: {x: number, y: number}
  speed: number;           // 移动速度
}
```

**控制方式**：
- 触摸屏幕移动（手机端H5）
- 自动射击，玩家只需控制移动
- 移动范围限制在屏幕内

### 敌人/障碍类型 ✅

#### 1. 小飞机
- **行为**：从上方生成，直线向下飞行
- **伤害方式**：撞击伤害（不发射子弹）
- **血量**：较低，1-2发子弹击毁
- **掉落**：有概率掉落道具

#### 2. 大炮
- **行为**：固定位置，旋转瞄准玩家
- **攻击方式**：发射炮弹
- **血量**：中等
- **特点**：需要玩家走位躲避

#### 3. 电网
- **行为**：静态障碍物
- **伤害**：触碰即受伤
- **特点**：不可摧毁，需要绕过

#### 4. Boss（简单设计）
```typescript
interface Boss {
  hp: 1000;                    // 较高血量
  phases: [
    {
      // 阶段1 (100%-50%血量)
      pattern: '左右移动 + 发射3连发子弹'
      fireRate: 1000  // 1秒发射一次
    },
    {
      // 阶段2 (50%-0%血量)
      pattern: '加快移动 + 发射5连发子弹'
      fireRate: 700   // 0.7秒发射一次
    }
  ]
  position: '屏幕上方中央'
  size: '玩家飞机的3倍大小'
}
```

### 道具系统 ✅
击杀敌人有概率掉落道具：

| 道具类型 | 效果 | 持续时间 | 掉落概率 |
|---------|------|---------|---------|
| 💚 血包 | 恢复20点生命值 | 立即生效 | 30% |
| 🔫 武器强化 | 攻击力+10 | 临时（10秒） | 25% |
| 🛡️ 护盾 | 防御力+20 | 临时（10秒） | 25% |
| ⚡ 加速 | 移动速度+50% | 临时（5秒） | 20% |

### 升级系统 ✅
- **关卡间升级**：通关后进入升级界面，用分数提升永久属性
  - 生命值上限 +20（消耗100分）
  - 攻击力 +5（消耗80分）
  - 防御力 +5（消耗80分）
  - 大招次数 +1（消耗150分）
- **战斗中提升**：拾取道具临时提升属性

### 关卡设计 ✅
- **关卡数量**：目前1关（可扩展）
- **关卡时长**：约30秒到达Boss
- **背景**：持续向上滚动，营造飞行感
- **敌人生成**：
  - 0-10秒：小飞机（2-3架）
  - 10-20秒：小飞机 + 大炮（混合）
  - 20-30秒：小飞机 + 电网（增加难度）
  - 30秒：Boss出现

## 3. 移动端H5适配 ✅

### 关键要求：
- [x] **触摸控制**：手指触摸屏幕移动飞机
- [x] **竖屏设计**：适配手机竖屏（9:16比例）
- [x] **响应式布局**：适配不同屏幕尺寸
- [x] **性能优化**：确保60fps流畅运行
- [x] **UI适配**：按钮足够大，易于点击

### 屏幕适配方案：
```typescript
// 推荐游戏画布尺寸
const gameConfig = {
  width: 375,   // 基准宽度（iPhone标准宽度）
  height: 667,  // 基准高度
  scale: {
    mode: Phaser.Scale.FIT,  // 自适应缩放
    autoCenter: Phaser.Scale.CENTER_BOTH
  }
}
```

### 触摸控制设计：
- 手指按住屏幕任意位置，飞机跟随手指移动
- 松开手指，飞机停止移动（或保持当前位置）
- 大招按钮：屏幕右下角固定位置（大按钮）

## 4. 视觉风格 ✅

### 已确定：
- [x] **配色方案**：黑白效果（复古街机风格）
  - 背景：黑色 (#000000)
  - 玩家飞机：白色 (#FFFFFF)
  - 敌人：白色轮廓
  - 子弹：白色
  - UI文字：白色
  - 特效：白色粒子

### 美术资源（简单几何图形）：
- **玩家飞机**：白色三角形（顶点朝上）
- **小飞机**：白色小三角形（顶点朝下）
- **大炮**：白色矩形 + 圆形炮管
- **电网**：白色网格线条
- **Boss**：白色大型多边形
- **子弹**：白色小圆点/椭圆
- **道具**：白色图标（圆形/方形带符号）
- **爆炸特效**：白色粒子扩散

## 4. 功能特性

### 基础功能：
- [ ] 开始游戏
- [ ] 暂停/继续
- [ ] 游戏结束和重新开始
- [ ] 得分显示

### 进阶功能：
- [ ] 关卡系统
- [ ] 难度选择
- [ ] 排行榜（本地存储）
- [ ] 音效和背景音乐
- [ ] 移动端适配

## 5. 项目结构（Vue 3 + Phaser 3 + TypeScript）

### 目录结构：
```
web_fly_game/
├── public/
│   └── assets/
│       ├── images/          # 游戏图片资源
│       │   ├── player.png
│       │   ├── enemy.png
│       │   ├── boss.png
│       │   ├── bullet.png
│       │   └── background.png
│       └── sounds/          # 音效资源
│           ├── shoot.mp3
│           ├── explosion.mp3
│           └── bgm.mp3
├── src/
│   ├── main.ts              # Vue入口
│   ├── App.vue              # 根组件
│   ├── router/
│   │   └── index.ts         # 路由配置
│   ├── stores/
│   │   └── game.ts          # Pinia状态管理
│   ├── views/
│   │   ├── HomeView.vue     # 主菜单
│   │   ├── GameView.vue     # 游戏页面
│   │   ├── UpgradeView.vue  # 升级界面
│   │   └── RankView.vue     # 排行榜
│   ├── components/
│   │   └── PhaserGame.vue   # Phaser游戏容器组件
│   └── game/                # Phaser游戏逻辑
│       ├── main.ts          # Phaser配置
│       ├── scenes/
│       │   ├── GameScene.ts # 主游戏场景
│       │   └── UIScene.ts   # UI覆盖层
│       ├── entities/
│       │   ├── Player.ts    # 玩家飞机类
│       │   ├── Enemy.ts     # 敌人基类
│       │   ├── SmallPlane.ts
│       │   ├── Cannon.ts
│       │   ├── ElectricNet.ts
│       │   ├── Boss.ts
│       │   ├── Bullet.ts
│       │   └── PowerUp.ts   # 道具类
│       ├── managers/
│       │   ├── EnemyManager.ts    # 敌人生成管理
│       │   ├── CollisionManager.ts # 碰撞检测
│       │   └── ScoreManager.ts    # 分数管理
│       └── types/
│           └── index.ts     # TypeScript类型定义
├── index.html
├── package.json
├── tsconfig.json
├── vite.config.ts
└── README.md
```

## 6. 开发优先级

### 第一阶段 - 项目搭建（MVP基础）
1. ✅ 初始化Vue 3 + Vite + TypeScript项目
2. ✅ 安装Phaser 3依赖
3. ✅ 配置路由和状态管理
4. ✅ 创建基础页面结构
5. ✅ 集成Phaser到Vue组件

### 第二阶段 - 核心游戏玩法
1. 玩家飞机
   - 触摸控制移动
   - 自动射击
   - 血条显示
2. 基础敌人（小飞机）
   - 生成和移动
   - 碰撞检测
   - 击毁效果
3. 背景滚动
4. 得分系统

### 第三阶段 - 完善敌人系统
1. 大炮（瞄准射击）
2. 电网（静态障碍）
3. Boss战（两阶段）
4. 道具掉落系统

### 第四阶段 - 升级和UI
1. 关卡间升级界面
2. 大招系统
3. 游戏结束/胜利界面
4. 主菜单和设置

### 第五阶段 - 优化和完善
1. 音效和背景音乐
2. 粒子特效
3. 移动端性能优化
4. 本地存储排行榜

---

## 技术要点总结

### 核心数值设计
```typescript
// 玩家初始属性
const PLAYER_INITIAL = {
  hp: 100,
  maxHp: 100,
  attack: 10,
  defense: 0,
  speed: 200,
  ultimateCount: 3
}

// 敌人属性
const ENEMIES = {
  smallPlane: { hp: 20, damage: 10, score: 10 },
  cannon: { hp: 50, damage: 15, score: 25 },
  electricNet: { damage: 20, score: 0 },
  boss: { hp: 1000, damage: 30, score: 500 }
}

// 道具效果
const POWERUPS = {
  health: { value: 20, duration: 0 },
  attackBoost: { value: 10, duration: 10000 },
  shieldBoost: { value: 20, duration: 10000 },
  speedBoost: { value: 1.5, duration: 5000 }
}
```

### 移动端优化要点
- 使用对象池减少GC
- 限制同屏敌人数量（<20个）
- 图片资源压缩（使用WebP格式）
- 禁用不必要的物理引擎功能
- 使用requestAnimationFrame优化渲染

---

## 下一步行动

准备开始开发了吗？我可以：

1. **立即开始搭建项目** - 初始化Vue + Phaser项目结构
2. **先准备美术资源** - 讨论使用简单几何图形还是找图片素材
3. **调整游戏设计** - 如果还有需要修改的地方

请告诉我您的选择！
